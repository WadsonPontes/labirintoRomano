<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Labirinto Romano</title>
	<link rel="icon" type="image/png" href="img/menu/logo.png">
	<style type="text/css">
		@font-face {
  			font-family: WadKingFont;
  			src: url(font/WadKingFont.ttf);
		}
		*{
			font-family: WadKingFont;
			color: #fff;
			word-break: break-word;
			box-sizing: border-box;
		}
		body {
			width: 100vw;
			height: 100vh;
			margin: 0;
			padding: 0;
			background-color: #AAF3EC;
			overflow: hidden;
		}
		.desativado {
			display: none!important;
		}
		/* MENU PRINCIPAL */
		#inicial, #regras, #partida {
			display: flex;
			flex-wrap: wrap;
			flex-direction: column;
			justify-content: center;
			align-content: center;
			width: 100vw;
			height: 100vh;
		}
		.botao {
			max-width: 100vw;
			padding: 15px 40px;
			font-size: 35px;
			border-top: 2px solid #f00;
			border-left: 2px solid #f00;
			border-right: 2px solid #f00;
			border-bottom: 7px solid #f00;
			background-color: #FF5050;
			border-radius: 25px;
			cursor: pointer;
		}
		.botao:hover{
			margin: 10vh auto 5vh auto;
			border-top: 2px solid #3EB060;
			border-left: 2px solid #3EB060;
			border-right: 2px solid #3EB060;
			border-bottom: 7px solid #3EB060;
			background-color: #70E292;
		}
		#logo {
			max-width: 100vw;
			max-height: 60vh;
		}
		#botao-start {
			margin: 10vh auto 5vh auto;
		}
		/* REGRAS */
		#caixa-texto {
			max-width: 90vw;
			max-height: 90vh;
			padding: 50px 50px 100px 50px;
			border-radius: 25px;
			background-color: #FF6666;
		}
		#titulo {
			font-size: 40px;
			text-align: center;
		}
		#texto {
			font-size: 20px;
		}
		#botao-ok {
			position: absolute;
			left: 0;
			right: 0;
			margin: 0 auto;
			font-size: 40px;
		}
		/* PARTIDA */
		#partida {
			justify-content: end;
		}
		.status {
			position: fixed;
			top: 0;
			font-size: 25px;
			z-index: 1;
		}
		#status0 {
			left: 0;
  			text-align: left;
		}
		#status1 {
			right: 0;
  			text-align: right;
		}
		.tabuleiro {
			display: grid;
			grid-template-columns: repeat(10, calc(min(5vw, 10vh)));
			grid-template-rows: repeat(10, calc(min(5vw, 10vh)));
			position: absolute;
			bottom: 0;
		}
		#tabuleiro0 {
			left: 0;
		}
		#tabuleiro1 {
			right: 0;
		}
		.celula {
			display: flex;
			align-items: center;
			justify-content: center;
  			aspect-ratio: 1;
			font-size: calc(min(2vw, 2vh));
			background-size: cover;
		}
		.jogador {
			position: absolute;
			width: calc(min(5vw, 10vh));
			height: calc(min(5vw, 10vh));
			background-size: cover;
			transform-origin: center;
		}
		#jogador0 {
			background-image: url('img/jogador0/parado/0.png')
		}
		#jogador1 {
			background-image: url('img/jogador1/parado/0.png')
		}


		


		
		#botao-back {
			top: 500px;
			left: 0;
			right: 0;
			margin: auto;
			font-size: 50px;
		}

		@media (orientation: portrait) {
			.tabuleiro {
				display: grid;
				grid-template-columns: repeat(10, calc(min(10vw, 5vh)));
				grid-template-rows: repeat(10, calc(min(10vw, 5vh)));
				position: relative;
			}
			.jogador {
				width: calc(min(10vw, 5vh));
				height: calc(min(10vw, 5vh));
			}
			#jogador0 {
				left: var(--jogador0-x)!important;
				top: var(--jogador0-y)!important;
			}
			#jogador1 {
				left: var(--jogador1-x)!important;
				top: var(--jogador1-y)!important;
			}
		}
	</style>
</head>
<body>
	<div id="preload" class="desativado"><img src="img/celulas/muro.png"><img src="img/celulas/porta.png"><img src="img/celulas/grama.png"><img src="img/menu/logo.png"><img src="img/menu/victory1.png"><img src="img/menu/victory2.png"><img src="img/jogador1/0.png"><img src="img/jogador2/0.png"><img src="img/status/vida0.png"><img src="img/status/vida1.png"><img src="img/status/vida2.png"><img src="img/status/vida3.png"><img src="img/status/vida4.png"><img src="img/status/vida5.png"></div>
	
	<div id="inicial">
		<img id="logo" src="img/menu/logo.png">
		<button id="botao-start" class="botao" onclick="eventoPrecionado()">start</button>
	</div>

	<div id="regras" class="desativado">
		<div id="caixa-texto">
			<div id="titulo">RegRas</div>
			<br/>
			<br/>
			<div id="texto">
				o gaRoto deve aNdaR poR casas PaRes com as teclas Wasd
				<br/>
				<br/>
				a gaRota deve aNdaR PoR casas iMPaRes coM as setas do teclado
				<br/>
				<br/>
				PeRde queM ficaR seM vida
				<br/>
				<br/>
				gaNha queM eNcoNtRaR a saida PRiMeiRo ou sobReviveR
			</div>
			<br/>
			<br/>
			<button id="botao-ok" class="botao" onclick="eventoPrecionado()">Ok</button>
		</div>
	</div>

	<div id="partida" class="desativado">
		<div id="tabuleiro0" class="tabuleiro">
			<div id="c-0-0-0" class="celula"></div>
			<div id="c-0-0-1" class="celula"></div>
			<div id="c-0-0-2" class="celula"></div>
			<div id="c-0-0-3" class="celula"></div>
			<div id="c-0-0-4" class="celula"></div>
			<div id="c-0-0-5" class="celula"></div>
			<div id="c-0-0-6" class="celula"></div>
			<div id="c-0-0-7" class="celula"></div>
			<div id="c-0-0-8" class="celula"></div>
			<div id="c-0-0-9" class="celula"></div>

			<div id="c-0-1-0" class="celula"></div>
			<div id="c-0-1-1" class="celula"></div>
			<div id="c-0-1-2" class="celula"></div>
			<div id="c-0-1-3" class="celula"></div>
			<div id="c-0-1-4" class="celula"></div>
			<div id="c-0-1-5" class="celula"></div>
			<div id="c-0-1-6" class="celula"></div>
			<div id="c-0-1-7" class="celula"></div>
			<div id="c-0-1-8" class="celula"></div>
			<div id="c-0-1-9" class="celula"></div>

			<div id="c-0-2-0" class="celula"></div>
			<div id="c-0-2-1" class="celula"></div>
			<div id="c-0-2-2" class="celula"></div>
			<div id="c-0-2-3" class="celula"></div>
			<div id="c-0-2-4" class="celula"></div>
			<div id="c-0-2-5" class="celula"></div>
			<div id="c-0-2-6" class="celula"></div>
			<div id="c-0-2-7" class="celula"></div>
			<div id="c-0-2-8" class="celula"></div>
			<div id="c-0-2-9" class="celula"></div>

			<div id="c-0-3-0" class="celula"></div>
			<div id="c-0-3-1" class="celula"></div>
			<div id="c-0-3-2" class="celula"></div>
			<div id="c-0-3-3" class="celula"></div>
			<div id="c-0-3-4" class="celula"></div>
			<div id="c-0-3-5" class="celula"></div>
			<div id="c-0-3-6" class="celula"></div>
			<div id="c-0-3-7" class="celula"></div>
			<div id="c-0-3-8" class="celula"></div>
			<div id="c-0-3-9" class="celula"></div>

			<div id="c-0-4-0" class="celula"></div>
			<div id="c-0-4-1" class="celula"></div>
			<div id="c-0-4-2" class="celula"></div>
			<div id="c-0-4-3" class="celula"></div>
			<div id="c-0-4-4" class="celula"></div>
			<div id="c-0-4-5" class="celula"></div>
			<div id="c-0-4-6" class="celula"></div>
			<div id="c-0-4-7" class="celula"></div>
			<div id="c-0-4-8" class="celula"></div>
			<div id="c-0-4-9" class="celula"></div>

			<div id="c-0-5-0" class="celula"></div>
			<div id="c-0-5-1" class="celula"></div>
			<div id="c-0-5-2" class="celula"></div>
			<div id="c-0-5-3" class="celula"></div>
			<div id="c-0-5-4" class="celula"></div>
			<div id="c-0-5-5" class="celula"></div>
			<div id="c-0-5-6" class="celula"></div>
			<div id="c-0-5-7" class="celula"></div>
			<div id="c-0-5-8" class="celula"></div>
			<div id="c-0-5-9" class="celula"></div>

			<div id="c-0-6-0" class="celula"></div>
			<div id="c-0-6-1" class="celula"></div>
			<div id="c-0-6-2" class="celula"></div>
			<div id="c-0-6-3" class="celula"></div>
			<div id="c-0-6-4" class="celula"></div>
			<div id="c-0-6-5" class="celula"></div>
			<div id="c-0-6-6" class="celula"></div>
			<div id="c-0-6-7" class="celula"></div>
			<div id="c-0-6-8" class="celula"></div>
			<div id="c-0-6-9" class="celula"></div>

			<div id="c-0-7-0" class="celula"></div>
			<div id="c-0-7-1" class="celula"></div>
			<div id="c-0-7-2" class="celula"></div>
			<div id="c-0-7-3" class="celula"></div>
			<div id="c-0-7-4" class="celula"></div>
			<div id="c-0-7-5" class="celula"></div>
			<div id="c-0-7-6" class="celula"></div>
			<div id="c-0-7-7" class="celula"></div>
			<div id="c-0-7-8" class="celula"></div>
			<div id="c-0-7-9" class="celula"></div>

			<div id="c-0-8-0" class="celula"></div>
			<div id="c-0-8-1" class="celula"></div>
			<div id="c-0-8-2" class="celula"></div>
			<div id="c-0-8-3" class="celula"></div>
			<div id="c-0-8-4" class="celula"></div>
			<div id="c-0-8-5" class="celula"></div>
			<div id="c-0-8-6" class="celula"></div>
			<div id="c-0-8-7" class="celula"></div>
			<div id="c-0-8-8" class="celula"></div>
			<div id="c-0-8-9" class="celula"></div>

			<div id="c-0-9-0" class="celula"></div>
			<div id="c-0-9-1" class="celula"></div>
			<div id="c-0-9-2" class="celula"></div>
			<div id="c-0-9-3" class="celula"></div>
			<div id="c-0-9-4" class="celula"></div>
			<div id="c-0-9-5" class="celula"></div>
			<div id="c-0-9-6" class="celula"></div>
			<div id="c-0-9-7" class="celula"></div>
			<div id="c-0-9-8" class="celula"></div>
			<div id="c-0-9-9" class="celula"></div>

			<div id="jogador0" class="jogador"></div>
		</div>

		<div id="tabuleiro1" class="tabuleiro">
			<div id="c-1-0-0" class="celula"></div>
			<div id="c-1-0-1" class="celula"></div>
			<div id="c-1-0-2" class="celula"></div>
			<div id="c-1-0-3" class="celula"></div>
			<div id="c-1-0-4" class="celula"></div>
			<div id="c-1-0-5" class="celula"></div>
			<div id="c-1-0-6" class="celula"></div>
			<div id="c-1-0-7" class="celula"></div>
			<div id="c-1-0-8" class="celula"></div>
			<div id="c-1-0-9" class="celula"></div>

			<div id="c-1-1-0" class="celula"></div>
			<div id="c-1-1-1" class="celula"></div>
			<div id="c-1-1-2" class="celula"></div>
			<div id="c-1-1-3" class="celula"></div>
			<div id="c-1-1-4" class="celula"></div>
			<div id="c-1-1-5" class="celula"></div>
			<div id="c-1-1-6" class="celula"></div>
			<div id="c-1-1-7" class="celula"></div>
			<div id="c-1-1-8" class="celula"></div>
			<div id="c-1-1-9" class="celula"></div>

			<div id="c-1-2-0" class="celula"></div>
			<div id="c-1-2-1" class="celula"></div>
			<div id="c-1-2-2" class="celula"></div>
			<div id="c-1-2-3" class="celula"></div>
			<div id="c-1-2-4" class="celula"></div>
			<div id="c-1-2-5" class="celula"></div>
			<div id="c-1-2-6" class="celula"></div>
			<div id="c-1-2-7" class="celula"></div>
			<div id="c-1-2-8" class="celula"></div>
			<div id="c-1-2-9" class="celula"></div>

			<div id="c-1-3-0" class="celula"></div>
			<div id="c-1-3-1" class="celula"></div>
			<div id="c-1-3-2" class="celula"></div>
			<div id="c-1-3-3" class="celula"></div>
			<div id="c-1-3-4" class="celula"></div>
			<div id="c-1-3-5" class="celula"></div>
			<div id="c-1-3-6" class="celula"></div>
			<div id="c-1-3-7" class="celula"></div>
			<div id="c-1-3-8" class="celula"></div>
			<div id="c-1-3-9" class="celula"></div>

			<div id="c-1-4-0" class="celula"></div>
			<div id="c-1-4-1" class="celula"></div>
			<div id="c-1-4-2" class="celula"></div>
			<div id="c-1-4-3" class="celula"></div>
			<div id="c-1-4-4" class="celula"></div>
			<div id="c-1-4-5" class="celula"></div>
			<div id="c-1-4-6" class="celula"></div>
			<div id="c-1-4-7" class="celula"></div>
			<div id="c-1-4-8" class="celula"></div>
			<div id="c-1-4-9" class="celula"></div>

			<div id="c-1-5-0" class="celula"></div>
			<div id="c-1-5-1" class="celula"></div>
			<div id="c-1-5-2" class="celula"></div>
			<div id="c-1-5-3" class="celula"></div>
			<div id="c-1-5-4" class="celula"></div>
			<div id="c-1-5-5" class="celula"></div>
			<div id="c-1-5-6" class="celula"></div>
			<div id="c-1-5-7" class="celula"></div>
			<div id="c-1-5-8" class="celula"></div>
			<div id="c-1-5-9" class="celula"></div>

			<div id="c-1-6-0" class="celula"></div>
			<div id="c-1-6-1" class="celula"></div>
			<div id="c-1-6-2" class="celula"></div>
			<div id="c-1-6-3" class="celula"></div>
			<div id="c-1-6-4" class="celula"></div>
			<div id="c-1-6-5" class="celula"></div>
			<div id="c-1-6-6" class="celula"></div>
			<div id="c-1-6-7" class="celula"></div>
			<div id="c-1-6-8" class="celula"></div>
			<div id="c-1-6-9" class="celula"></div>

			<div id="c-1-7-0" class="celula"></div>
			<div id="c-1-7-1" class="celula"></div>
			<div id="c-1-7-2" class="celula"></div>
			<div id="c-1-7-3" class="celula"></div>
			<div id="c-1-7-4" class="celula"></div>
			<div id="c-1-7-5" class="celula"></div>
			<div id="c-1-7-6" class="celula"></div>
			<div id="c-1-7-7" class="celula"></div>
			<div id="c-1-7-8" class="celula"></div>
			<div id="c-1-7-9" class="celula"></div>

			<div id="c-1-8-0" class="celula"></div>
			<div id="c-1-8-1" class="celula"></div>
			<div id="c-1-8-2" class="celula"></div>
			<div id="c-1-8-3" class="celula"></div>
			<div id="c-1-8-4" class="celula"></div>
			<div id="c-1-8-5" class="celula"></div>
			<div id="c-1-8-6" class="celula"></div>
			<div id="c-1-8-7" class="celula"></div>
			<div id="c-1-8-8" class="celula"></div>
			<div id="c-1-8-9" class="celula"></div>

			<div id="c-1-9-0" class="celula"></div>
			<div id="c-1-9-1" class="celula"></div>
			<div id="c-1-9-2" class="celula"></div>
			<div id="c-1-9-3" class="celula"></div>
			<div id="c-1-9-4" class="celula"></div>
			<div id="c-1-9-5" class="celula"></div>
			<div id="c-1-9-6" class="celula"></div>
			<div id="c-1-9-7" class="celula"></div>
			<div id="c-1-9-8" class="celula"></div>
			<div id="c-1-9-9" class="celula"></div>

			<div id="jogador1" class="jogador"></div>
		</div>
	</div>

	<div id="game-over" class="game-over desativado">
		<img id="victory" class="imagem" src="img/menu/victory1.png">
		<input id="botao-back" class="botao" type="button" value="back" onclick="voltar()">
	</div>

	<script>
		class Elementos {
			constructor() {
				this.inicial = document.querySelector('#inicial');
				this.regras = document.querySelector('#regras');
				this.partida = document.querySelector('#partida');
				this.jogadores = [document.querySelector('#jogador0'), document.querySelector('#jogador1')];
				this.celulas = [];
			}
		}

		class Celula {
			constructor(id, x, y, tipo = 'grama', valor = 'x') {
				this.id = id;
				this.x = x;
				this.y = y;
				this.tipo = tipo;
				this.valor = valor;
			}

			atualizar() {
				const e = elementos.celulas[this.id][this.x][this.y];
				if (this.valor && this.valor != '') e.style.backgroundImage = `url('img/celulas/chao.png')`;
				else e.style.backgroundImage = `url('img/celulas/${this.tipo}.png')`;
				e.textContent = this.valor;
			}
		}

		class Tabuleiro {
			constructor(id) {
				this.id = id;
				this.romanos = this.getRomanos();
				if (id) {
					this.celulas = [
						[
							new Celula(id, 0, 0, 'muro', ''),
							new Celula(id, 0, 1, 'porta', ''),
							new Celula(id, 0, 2, 'muro', ''),
							new Celula(id, 0, 3, 'muro', ''),
							new Celula(id, 0, 4, 'muro', ''),
							new Celula(id, 0, 5, 'muro', ''),
							new Celula(id, 0, 6, 'muro', ''),
							new Celula(id, 0, 7, 'muro', ''),
							new Celula(id, 0, 8, 'muro', ''),
							new Celula(id, 0, 9, 'muro', '')
						],
						[
							new Celula(id, 1, 0, 'muro', ''),
							new Celula(id, 1, 1, 'grama', this.getImpar()),
							new Celula(id, 1, 2, 'muro', this.getPar()),
							new Celula(id, 1, 3, 'muro', this.getPar()),
							new Celula(id, 1, 4, 'muro', this.getPar()),
							new Celula(id, 1, 5, 'grama', this.getImpar()),
							new Celula(id, 1, 6, 'grama', this.getImpar()),
							new Celula(id, 1, 7, 'grama', this.getImpar()),
							new Celula(id, 1, 8, 'muro', this.getPar()),
							new Celula(id, 1, 9, 'muro', '')
						],
						[
							new Celula(id, 2, 0, 'muro', ''),
							new Celula(id, 2, 1, 'grama', this.getImpar()),
							new Celula(id, 2, 2, 'grama', this.getImpar()),
							new Celula(id, 2, 3, 'grama', this.getImpar()),
							new Celula(id, 2, 4, 'grama', this.getImpar()),
							new Celula(id, 2, 5, 'grama', this.getImpar()),
							new Celula(id, 2, 6, 'muro', this.getPar()),
							new Celula(id, 2, 7, 'grama', this.getImpar()),
							new Celula(id, 2, 8, 'grama', this.getImpar()),
							new Celula(id, 2, 9, 'muro', '')
						],
						[
							new Celula(id, 3, 0, 'muro', ''),
							new Celula(id, 3, 1, 'muro', this.getPar()),
							new Celula(id, 3, 2, 'muro', this.getPar()),
							new Celula(id, 3, 3, 'muro', this.getPar()),
							new Celula(id, 3, 4, 'muro', this.getPar()),
							new Celula(id, 3, 5, 'muro', this.getPar()),
							new Celula(id, 3, 6, 'muro', this.getPar()),
							new Celula(id, 3, 7, 'muro', this.getPar()),
							new Celula(id, 3, 8, 'grama', this.getImpar()),
							new Celula(id, 3, 9, 'muro', '')
						],
						[
							new Celula(id, 4, 0, 'muro', ''),
							new Celula(id, 4, 1, 'grama', this.getImpar()),
							new Celula(id, 4, 2, 'grama', this.getImpar()),
							new Celula(id, 4, 3, 'grama', this.getImpar()),
							new Celula(id, 4, 4, 'grama', this.getImpar()),
							new Celula(id, 4, 5, 'grama', this.getImpar()),
							new Celula(id, 4, 6, 'grama', this.getImpar()),
							new Celula(id, 4, 7, 'grama', this.getImpar()),
							new Celula(id, 4, 8, 'grama', this.getImpar()),
							new Celula(id, 4, 9, 'muro', '')
						],
						[
							new Celula(id, 5, 0, 'muro', ''),
							new Celula(id, 5, 1, 'grama', this.getImpar()),
							new Celula(id, 5, 2, 'muro', this.getPar()),
							new Celula(id, 5, 3, 'muro', this.getPar()),
							new Celula(id, 5, 4, 'muro', this.getPar()),
							new Celula(id, 5, 5, 'muro', this.getPar()),
							new Celula(id, 5, 6, 'muro', this.getPar()),
							new Celula(id, 5, 7, 'muro', this.getPar()),
							new Celula(id, 5, 8, 'muro', this.getPar()),
							new Celula(id, 5, 9, 'muro', '')
						],
						[
							new Celula(id, 6, 0, 'muro', ''),
							new Celula(id, 6, 1, 'grama', this.getImpar()),
							new Celula(id, 6, 2, 'grama', this.getImpar()),
							new Celula(id, 6, 3, 'grama', this.getImpar()),
							new Celula(id, 6, 4, 'grama', this.getImpar()),
							new Celula(id, 6, 5, 'muro', this.getPar()),
							new Celula(id, 6, 6, 'grama', this.getImpar()),
							new Celula(id, 6, 7, 'grama', this.getImpar()),
							new Celula(id, 6, 8, 'grama', this.getImpar()),
							new Celula(id, 6, 9, 'muro', '')
						],
						[
							new Celula(id, 7, 0, 'muro', ''),
							new Celula(id, 7, 1, 'muro', this.getPar()),
							new Celula(id, 7, 2, 'grama', this.getImpar()),
							new Celula(id, 7, 3, 'muro', this.getPar()),
							new Celula(id, 7, 4, 'grama', this.getImpar()),
							new Celula(id, 7, 5, 'muro', this.getPar()),
							new Celula(id, 7, 6, 'grama', this.getImpar()),
							new Celula(id, 7, 7, 'muro', this.getPar()),
							new Celula(id, 7, 8, 'grama', this.getImpar()),
							new Celula(id, 7, 9, 'muro', '')
						],
						[
							new Celula(id, 8, 0, 'muro', ''),
							new Celula(id, 8, 1, 'grama', this.getImpar()),
							new Celula(id, 8, 2, 'grama', this.getImpar()),
							new Celula(id, 8, 3, 'muro', this.getPar()),
							new Celula(id, 8, 4, 'grama', this.getImpar()),
							new Celula(id, 8, 5, 'grama', this.getImpar()),
							new Celula(id, 8, 6, 'grama', this.getImpar()),
							new Celula(id, 8, 7, 'muro', this.getPar()),
							new Celula(id, 8, 8, 'grama', ''),
							new Celula(id, 8, 9, 'muro', '')
						],
						[
							new Celula(id, 9, 0, 'muro', ''),
							new Celula(id, 9, 1, 'muro', ''),
							new Celula(id, 9, 2, 'muro', ''),
							new Celula(id, 9, 3, 'muro', ''),
							new Celula(id, 9, 4, 'muro', ''),
							new Celula(id, 9, 5, 'muro', ''),
							new Celula(id, 9, 6, 'muro', ''),
							new Celula(id, 9, 7, 'muro', ''),
							new Celula(id, 9, 8, 'muro', ''),
							new Celula(id, 9, 9, 'muro', '')
						]
					];
				}
				else {
					this.celulas = [
						[
							new Celula(id, 0, 0, 'muro', ''),
							new Celula(id, 0, 1, 'muro', ''),
							new Celula(id, 0, 2, 'muro', ''),
							new Celula(id, 0, 3, 'muro', ''),
							new Celula(id, 0, 4, 'muro', ''),
							new Celula(id, 0, 5, 'muro', ''),
							new Celula(id, 0, 6, 'muro', ''),
							new Celula(id, 0, 7, 'muro', ''),
							new Celula(id, 0, 8, 'porta', ''),
							new Celula(id, 0, 9, 'muro', '')
						],
						[
							new Celula(id, 1, 0, 'muro', ''),
							new Celula(id, 1, 1, 'grama', this.getPar()),
							new Celula(id, 1, 2, 'grama', this.getPar()),
							new Celula(id, 1, 3, 'grama', this.getPar()),
							new Celula(id, 1, 4, 'muro', this.getImpar()),
							new Celula(id, 1, 5, 'muro', this.getImpar()),
							new Celula(id, 1, 6, 'muro', this.getImpar()),
							new Celula(id, 1, 7, 'muro', this.getImpar()),
							new Celula(id, 1, 8, 'grama', this.getPar()),
							new Celula(id, 1, 9, 'muro', '')
						],
						[
							new Celula(id, 2, 0, 'muro', ''),
							new Celula(id, 2, 1, 'grama', this.getPar()),
							new Celula(id, 2, 2, 'muro', this.getImpar()),
							new Celula(id, 2, 3, 'grama', this.getPar()),
							new Celula(id, 2, 4, 'grama', this.getPar()),
							new Celula(id, 2, 5, 'grama', this.getPar()),
							new Celula(id, 2, 6, 'grama', this.getPar()),
							new Celula(id, 2, 7, 'grama', this.getPar()),
							new Celula(id, 2, 8, 'grama', this.getPar()),
							new Celula(id, 2, 9, 'muro', '')
						],
						[
							new Celula(id, 3, 0, 'muro', ''),
							new Celula(id, 3, 1, 'grama', this.getPar()),
							new Celula(id, 3, 2, 'muro', this.getImpar()),
							new Celula(id, 3, 3, 'muro', this.getImpar()),
							new Celula(id, 3, 4, 'muro', this.getImpar()),
							new Celula(id, 3, 5, 'muro', this.getImpar()),
							new Celula(id, 3, 6, 'muro', this.getImpar()),
							new Celula(id, 3, 7, 'muro', this.getImpar()),
							new Celula(id, 3, 8, 'muro', this.getImpar()),
							new Celula(id, 3, 9, 'muro', '')
						],
						[
							new Celula(id, 4, 0, 'muro', ''),
							new Celula(id, 4, 1, 'grama', this.getPar()),
							new Celula(id, 4, 2, 'grama', this.getPar()),
							new Celula(id, 4, 3, 'grama', this.getPar()),
							new Celula(id, 4, 4, 'grama', this.getPar()),
							new Celula(id, 4, 5, 'grama', this.getPar()),
							new Celula(id, 4, 6, 'grama', this.getPar()),
							new Celula(id, 4, 7, 'grama', this.getPar()),
							new Celula(id, 4, 8, 'grama', this.getPar()),
							new Celula(id, 4, 9, 'muro', '')
						],
						[
							new Celula(id, 5, 0, 'muro', ''),
							new Celula(id, 5, 1, 'muro', this.getImpar()),
							new Celula(id, 5, 2, 'grama', this.getPar()),
							new Celula(id, 5, 3, 'muro', this.getImpar()),
							new Celula(id, 5, 4, 'muro', this.getImpar()),
							new Celula(id, 5, 5, 'muro', this.getImpar()),
							new Celula(id, 5, 6, 'muro', this.getImpar()),
							new Celula(id, 5, 7, 'muro', this.getImpar()),
							new Celula(id, 5, 8, 'grama', this.getPar()),
							new Celula(id, 5, 9, 'muro', '')
						],
						[
							new Celula(id, 6, 0, 'muro', ''),
							new Celula(id, 6, 1, 'grama', this.getPar()),
							new Celula(id, 6, 2, 'grama', this.getPar()),
							new Celula(id, 6, 3, 'muro', this.getImpar()),
							new Celula(id, 6, 4, 'grama', this.getPar()),
							new Celula(id, 6, 5, 'grama', this.getPar()),
							new Celula(id, 6, 6, 'grama', this.getPar()),
							new Celula(id, 6, 7, 'muro', this.getImpar()),
							new Celula(id, 6, 8, 'grama', this.getPar()),
							new Celula(id, 6, 9, 'muro', '')
						],
						[
							new Celula(id, 7, 0, 'muro', ''),
							new Celula(id, 7, 1, 'muro', this.getImpar()),
							new Celula(id, 7, 2, 'muro', this.getImpar()),
							new Celula(id, 7, 3, 'muro', this.getImpar()),
							new Celula(id, 7, 4, 'grama', this.getPar()),
							new Celula(id, 7, 5, 'muro', this.getImpar()),
							new Celula(id, 7, 6, 'grama', this.getPar()),
							new Celula(id, 7, 7, 'muro', this.getImpar()),
							new Celula(id, 7, 8, 'grama', this.getPar()),
							new Celula(id, 7, 9, 'muro', '')
						],
						[
							new Celula(id, 8, 0, 'muro', ''),
							new Celula(id, 8, 1, 'grama', ''),
							new Celula(id, 8, 2, 'grama', this.getPar()),
							new Celula(id, 8, 3, 'grama', this.getPar()),
							new Celula(id, 8, 4, 'grama', this.getPar()),
							new Celula(id, 8, 5, 'muro', this.getImpar()),
							new Celula(id, 8, 6, 'grama', this.getPar()),
							new Celula(id, 8, 7, 'grama', this.getPar()),
							new Celula(id, 8, 8, 'grama', this.getPar()),
							new Celula(id, 8, 9, 'muro', '')
						],
						[
							new Celula(id, 9, 0, 'muro', ''),
							new Celula(id, 9, 1, 'muro', ''),
							new Celula(id, 9, 2, 'muro', ''),
							new Celula(id, 9, 3, 'muro', ''),
							new Celula(id, 9, 4, 'muro', ''),
							new Celula(id, 9, 5, 'muro', ''),
							new Celula(id, 9, 6, 'muro', ''),
							new Celula(id, 9, 7, 'muro', ''),
							new Celula(id, 9, 8, 'muro', ''),
							new Celula(id, 9, 9, 'muro', '')
						]
					];
				}
				
				elementos.celulas[id] = [];

				for (let i = 0; i < 10; ++i) {
					elementos.celulas[id][i] = [];

					for (let j = 0; j < 10; ++j) {
						elementos.celulas[id][i][j] = document.querySelector(`#c-${id}-${i}-${j}`);
						this.celulas[i][j].atualizar();
					}
				}
			}

			getRomanos() {
				let romanos = { pares: [], impares: [] };
				let letras = [
					['', 'i', 'ii', 'iii', 'iv', 'v', 'vi', 'vii', 'viii', 'ix'],
					['', 'x', 'xx', 'xxx', 'xl', 'l', 'lx', 'lxx', 'lxxx', 'xc'],
					['', 'c', 'cc', 'ccc', 'cd', 'd', 'dc', 'dcc', 'dccc', 'cM'],
					['', 'M', 'MM', 'MMM']
				];

				for (let i = 1; i <= 3999; ++i) {
					let montante = {valor: i, letras: '', qtd_digitos: 0, par: i % 2 == 0};

					while (montante.valor) {
						let unidade = montante.valor % 10;
						montante.valor = Math.floor(montante.valor / 10);
						montante.letras = letras[montante.qtd_digitos][unidade] + montante.letras;
						++montante.qtd_digitos;
					}
					if (montante.letras.length < 4 && montante.par) {
						romanos.pares.splice(Math.floor(Math.random() * (romanos.pares.length + 1)), 0, montante.letras);
					}
					else if (montante.letras.length < 4 && !montante.par) {
						romanos.impares.splice(Math.floor(Math.random() * (romanos.impares.length + 1)), 0, montante.letras);
					}
				}

				return romanos;
			}

			getPar() {
				return this.romanos.pares.pop();
			}

			getImpar() {
				return this.romanos.impares.pop();
			}
		}

		class Animacao {
			constructor(id, nome, direcao, qtd_quadros, iteracoes) {
				this.id = id;
				this.nome = nome;
				this.duracao = direcao;
				this.iteracoes = iteracoes;
				this.qtd_quadros = qtd_quadros;
				this.tempo = { duration: this.duracao, iterations: this.iteracoes };
				this.quadros = [];

				for (let i = 0; i < qtd_quadros; ++i) {
					this.quadros[i] = { backgroundImage: `url('img/jogador${id}/${nome}/${i}.png')` };
				}
				if (nome == 'caindo') {
					for (let i = 0; i < qtd_quadros * (id ? 2 : 3); ++i) {
						const r = id ? 4 : 2;
						for (let j = 0; j < r; ++j) { // Repete o mesmo frame 4 vezes para manter a mesma velocidade na animação
							this.quadros[qtd_quadros + j + (i * r)] = { backgroundImage: `url('img/jogador${id}/${nome}/${qtd_quadros + (i % 6)}.png')` };
						}
					}
				}
			}
		}

		class Animacoes {
			constructor(id) {
				this.id = id;
				this.parado = new Animacao(id, 'parado', 500, 1, Infinity);
				this.andando = new Animacao(id, 'andando', 500, (id ? 21 : 16), 1);
				this.caindo = new Animacao(id, 'caindo', 5000, (id ? 31 : 16), 1);
			}
		}

		class Jogador {
			constructor(id) {
				this.id = id;
				this.x = id ? 8 : 1;
				this.y = 8;
				this.direcao = id ? -1 : 1;
				this.tabuleiro = new Tabuleiro(id);
				this.vidas = 5;
				this.estado = 'parado';
				this.animacoes = new Animacoes(id);
				this.atualizar();
				elementos.jogadores[id].animate(this.animacoes.parado.quadros, this.animacoes.parado.tempo);
			}

			atualizar() {
				const e = elementos.jogadores[this.id];
				e.style.transform = `scaleX(${this.direcao})`;
				e.style.left = `calc(min(${this.x * 5}vw, ${this.x * 10}vh))`;
				e.style.top = `calc(min(${this.y * 5}vw, ${this.y * 10}vh))`;
				document.documentElement.style.setProperty(`--jogador${this.id}-x`, `calc(min(${this.x * 10}vw, ${this.x * 5}vh))`);
				document.documentElement.style.setProperty(`--jogador${this.id}-y`, `calc(min(${this.y * 10}vw, ${this.y * 5}vh))`);
			}

			andar(tecla) {
				const e = elementos.jogadores[this.id];
				const d = this.animacoes.andando.duracao/1000;
				this.x += tecla.x;
				this.y += tecla.y;
				if (tecla.x) this.direcao = tecla.x;
				this.estado = 'andando';
				this.tabuleiro.celulas[this.y][this.x].valor = '';
				this.tabuleiro.celulas[this.y][this.x].atualizar();
				e.style.transition = `top ${d}s linear, left ${d}s linear`;
				this.atualizar();
				e.animate(this.animacoes.andando.quadros, this.animacoes.andando.tempo);
				setTimeout(() => {
					this.estado = 'parado';
					e.style.transition = 'none';
					e.animate(this.animacoes.parado.quadros, this.animacoes.parado.tempo);
				}, this.animacoes.andando.duracao);
			}

			cair(tecla) {
				const e = elementos.jogadores[this.id];
				const d = this.animacoes.caindo.duracao/1000;
				if (tecla.x) this.direcao = tecla.x;
				this.estado = 'caindo';
				this.tabuleiro.celulas[this.y + tecla.y][this.x + tecla.x].valor = '';
				this.tabuleiro.celulas[this.y + tecla.y][this.x + tecla.x].atualizar();
				e.style.transition = `top ${d}s linear, left ${d}s linear`;
				this.atualizar();
				e.animate(this.animacoes.caindo.quadros, this.animacoes.caindo.tempo);
				setTimeout(() => {
					this.estado = 'parado';
					e.style.transition = 'none';
					e.animate(this.animacoes.parado.quadros, this.animacoes.parado.tempo);
				}, this.animacoes.caindo.duracao);
			}
		}

		class Tecla {
			constructor(k, x, y, jogador) {
				this.id = k;
				this.x = x;
				this.y = y;
				this.jogador = jogador;
			}
		}

		class Teclas {
			constructor(jogador0, jogador1) {
				this.KeyW = new Tecla('KeyW', 0, -1, jogador0);
				this.KeyD = new Tecla('KeyD', 1, 0, jogador0);
				this.KeyS = new Tecla('KeyS', 0, 1, jogador0);
				this.KeyA = new Tecla('KeyA', -1, 0, jogador0);

				this.ArrowUp = new Tecla('ArrowUp', 0, -1, jogador1);
				this.ArrowRight = new Tecla('ArrowRight', 1, 0, jogador1);
				this.ArrowDown = new Tecla('ArrowDown', 0, 1, jogador1);
				this.ArrowLeft = new Tecla('ArrowLeft', -1, 0, jogador1);
			}
		}

		class Dados {
			constructor() {
				this.tela = 'inicial';
				this.jogador0 = new Jogador(0);
				this.jogador1 = new Jogador(1);
				this.teclas = new Teclas(this.jogador0, this.jogador1);
			}
		}

		const elementos = new Elementos();
		const dados = new Dados();
		
		function isTelaConfirmacao(e) {
			return e == null || e.code == 'Enter' || e.code == 'Space';
		}

		function trocarTela(nova) {
			elementos[dados.tela].classList.add('desativado');
			elementos[nova].classList.remove('desativado');
			dados.tela = nova;
		}

		function isMovimentoValido(k) {
			return k.jogador.tabuleiro.celulas[k.jogador.y+k.y][k.jogador.x+k.x].tipo == 'grama';
		}

		function isBateuNaParede(k) {
			return k.jogador.tabuleiro.celulas[k.jogador.y+k.y][k.jogador.x+k.x].valor != '';
		}

		function movimentar(e) {
			const k = dados.teclas[e.code];

			if (k && isMovimentoValido(k) && k.jogador.estado == 'parado') {
				k.jogador.andar(k);
			}
			else if (k && isBateuNaParede(k) && k.jogador.estado == 'parado') {
				k.jogador.cair(k);
			}
		}

		function eventoPrecionado(e) {
			if (dados.tela == 'inicial' && isTelaConfirmacao(e)) {
				trocarTela('regras');
			}
			else if (dados.tela == 'regras' && isTelaConfirmacao(e)) {
				trocarTela('partida');
			}
			else if (dados.tela == 'partida') {
				movimentar(e);
			}
		}





		function gameOver(campo, resultado) {
			if (resultado == "vitoria") {
				img_wins.src = "img/menu/victory" + campo.id + ".png";
			}
			else {
				img_wins.src = "img/menu/victory" + (3 - campo.id) + ".png";
			}
			estado = "game_over";
			partida.classList.add("desativado");
			game_over.classList.remove("desativado");

			for (let k = 1; k < 3; k++) {
				for (let i = 0; i < 8; i++) {
					for (let j = 0; j < 10; j++) {
						document.getElementById("casa" + k + i + j).innerHTML = "";
						document.getElementById("casa" + k + i + j).classList.remove("verde");
						document.getElementById("casa" + k + i + j).classList.remove("vermelho");
					}
				}
				img_vidas[k].src = "img/status/vida5.png";
			}
		}

		function voltar() {
			menu.classList.remove("desativado");
			game_over.classList.add("desativado");
		}

		window.addEventListener("keydown", eventoPrecionado);
	</script>
</body>
</html>